from openpyxl import load_workbook
import os

# 你的数据（可替换为读取 Excel）
data = [
    ["2025年4月3日", "数据问题", "人员统计、管养道路数据显示不准确", "樊燕伟", 0.5, "张森"],
    ["2025年4月8日", "数据问题", "停车工单列表数据未更新，联合停车平台技术排查、联调", "樊燕伟", 0.5, "张森"],
    ["2025年4月11日", "数据问题", "停车数据报错，因停车系统新增1个停车场，停车场的多个字段的数据是空值，导致数据推送的时候报错", "樊燕伟", 0.5, "张森"],
    ["2025年5月25日", "漏洞修复", "redis版本、Guava版本、Spring Security版本、检测目录权限等漏洞修复", "樊燕伟", 3, "张森"],
    ["2025年6月17日", "漏洞修复", "弱口令漏洞，前端代码明文保存账号、密码", "网安行动", 0.5, "张森"],
    ["2025年6月17日", "漏洞修复", "任意文件读取漏洞，对文件读取接口增加输入验证", "网安行动", 0.5, "张森"],
    ["2025年6月18日", "安全问题", "密码明文传输问题修复", "田大魁", 1, "张森、王慧德"],
    ["2025年6月19日", "漏洞修复", "信息泄露漏洞，去除静态资源中敏感url，改为从后端获取并对接口添加权限", "网安行动", 0.5, "张森"],
    ["2025年6月19日", "漏洞修复", "未授权访问漏洞，前端调用停车Get接口，暴露接口地址，调整为后端调用", "网安行动", 1, "张森、王慧德"],
    ["2025年6月24日", "功能完善", "用户管理功能导出数据中添加登录ip、登录时间记录", "奚晓军", 1, "张森、王慧德"],
    ["2025年6月24日", "技术支持", "不同功能板块业务日志记录，统计不同板块的系统访问量，不同用户角色的访问量，提供相关界面截图、SQL语句截图", "樊燕伟", 0.5, "张森"],
    ["2025年6月25日", "技术支持", "导出用户添加字段", "", 0.5, "张森"],
    ["2025年6月27日", "技术支持", "添加第三方登录接口，添加token跳转", "", 0.5, "张森、王慧德"],
    ["2025年6月30日", "漏洞修复", "修复系统漏洞，最终使用白名单方案", "", 1, "张森"],
    ["2025年7月2日", "审计", "统计访问量，填写功能完成情况", "樊燕伟", 0.5, "张森"],
    ["2025年7月10日", "网络安全防护措施", "修改系统登录异常返回信息，修改系统内修改密码校验，添加账户登录失败限制，添加登录密码校验，第三方系统对接方式修改", "樊燕伟", 1.5, "张森、王慧德"],
    ["2025年7月11日", "网络安全防护措施", "修复系统帐户风险", "樊燕伟", 1, "张森"],
    ["2025年7月23日", "漏洞修复", "升级tomcat版本，Jackson版本，查看并修复系统权限漏洞", "樊燕伟", 0.5, "张森"],
    ["2025年7月31日", "修改单点登录", "修改环卫系统跳转地址，更换单点登录方式", "王子恺", 2, "张森、王慧德"]
]

# 创建输出目录
output_dir = "输出表格"
os.makedirs(output_dir, exist_ok=True)

for row in data:
    时间, 事项, 描述, 提出人, 工作量, 开发 = row

    # 加载模板
    wb = load_workbook("问题处理与跟踪记录.xlsx")
    ws = wb.active

    # 写入对应单元格
    ws["E3"] = 开发
    ws["E4"] = 时间
    ws["C4"] = 工作量
    ws["C5"] = 描述
    ws["G3"] = 提出人

    # 格式化文件名
    safe_time = 时间.replace("年", "-").replace("月", "-").replace("日", "")
    filename = f"问题处理与跟踪记录_{时间}.xlsx"
    filepath = os.path.join(output_dir, filename)

    # 保存文件
    wb.save(filepath)

print("✅ 所有Excel文件已生成，命名格式为“问题处理与跟踪记录_日期.xlsx”。")
